---
title: "Gov 50 Final Project"
author: "Julia High"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---

INTRODUCTION: 

	My research question is: “Do Democrat and Republican views on 5 major social issues differ by racial group?” My hypothesis is that yes, Democrat and Republican views on 5 major social issues will differ by racial group. For this project, the five key social issues I am investigating are abortion, LGBTQ+ rights, immigration, the environment, and the economy. The racial groups I am investigating are “White, non-Hispanic,” “Black, non-Hispanic,” “Hispanic,” “Asian or Native Hawaiian/other Pacific Islander, non-Hispanic,” and “Multiple races, non-Hispanic.” Additionally, I will use the two major parties, Democrats and Republicans, for my analysis. A lot of public opinion research collects respondents’ race, and responses are often analyzed through that lens. Given the history of racial polarization in the United States, analyzing different racial groups’ opinions can reveal interesting contrasts. However, I have not observed many analyses on racial differences within party groups. This is nonetheless significant, given that politicians spend considerable time targeting key racial demographics in elections. This analysis is particularly relevant given the upcoming presidential election in 2024. Additionally, the United States population is rapidly diversifying, so politicians will have no choice but to identify the needs and values of key racial demographic groups. Party players will no longer be able to take advantage of the fact that certain racial groups have historically voted for their party. I hope that my analysis will reveal nuances within party lines and across racial groups that may inspire more comprehensive research in this area. 


DATA: 

My data comes from the American National Election Studies 2020 Time Series study. This source is a public opinion survey of over 8,000 Americans in 2020 about a number of different topics. Party affiliation and race are self-reported in the survey.

I am measuring respondents’ views on my five key social issues based on the following survey questions.

Abortion
Question: There has been some discussion about abortion during recent years. Which one of the opinions on this page best agrees with your view? 
Response options: 1 (By law, abortion should never be permitted) through 5 (By law, a woman should always be able to obtain an abortion as a matter of personal choice).

LGBTQ+ Rights
Question: Which comes closest to your view [on gay marriage]? You can just tell me the number of your choice.
Response options: 1 (Gay and lesbian couples should be allowed to legally marry) through 3 (There should be no legal recognition of gay or lesbian couples’ relationship).

Immigration
Question: Which comes closest to your view about what government policy should be toward unauthorized immigrants now living in the United States?
Response options: 1 (Make all unauthorized immigrants felons and send them back to their home country) through 4 (Allow unauthorized immigrants to remain in US & eventually qualify for citizenship without penalties).

Environment
Question: Where would you place yourself on this scale, or haven’t you thought much about this?
Response options: 1 (Tougher regulations on business needed to protect environment) through 7 (Regulations to protect environment already too much a burden on business).

Economy
Question: What do you think about the state of the economy these days in the United States? Would you say the state of the economy is very good,good, neither good nor bad, bad, or very bad?
Response options: 1(Very good) through 5 (Very bad).

While these categories may not entirely reflect of respondents’ views on a given issue, they offer a solid foundation to reveal potential differences by race and party.

The research design for this study is BLANK.


```{r}
library(tidyverse)
library(dplyr)
```

```{r}
voting_trends_2020 <- read_csv("anes_timeseries_2020_csv_20220210.csv")
voting_trends_2020
```
```{r}
voting_trends_2020 |>
  select(V201601) |>
  filter(V201601 >= 1)
```


confounders: education, gender, sexuality 

```{r}
voting_trends_2020 <- voting_trends_2020 |>
  select(V201549x, V201336, V201416, V201417, V201262, V201324, V201018, V201510, V201600, V201601) |>
  filter(
    V201549x >= 1,
    V201018 == 1 | V201018 == 2,
    V201336 %in% c(1,2,3,4),
    V201416 >= 1,
    V201417 >= 1,
    V201262 %in% c(1, 2, 3, 4, 5, 6, 7),
    V201324 >= 1,
    V201510 %in% c(1, 2, 3, 4, 5, 6, 7, 8),
    V201600 >= 1,
    V201601 %in% c(1, 2, 3)
  )
voting_trends_2020
```

```{r}
voting_trends <- voting_trends_2020 |>
  rename(
    race_num = V201549x,
    abortion_views = V201336,
    lgbtq_views = V201416,
    immigration_views = V201417,
    environment_views = V201262,
    economy_views = V201324,
    party = V201018,
    education_level = V201510,
    gender = V201600,
    sexuality = V201601
  ) |>
  mutate(
    race = case_when(
      race_num == 1 ~ "White, non-Hispanic",
      race_num == 2 ~ "Black, non-Hispanic",
      race_num == 3 ~ "Hispanic",
      race_num == 4 ~ "Asian or Native Hawaiian/other Pacific Islander, non-Hispanic",
      race_num == 5 ~ "Native American/Alaska Native or other race, non-Hispanic",
      race_num == 6 ~ "Multiple races, non-Hispanic"
    ),
    party = if_else(party == 1, "Democrat", "Republican"),
    gender = if_else(gender == 1, "Male", "Female"),
    education_level = case_when(
      education_level == 1 ~ "Less than high school",
      education_level == 2 ~ "High school graduate",
      education_level == 3 ~ "Some college but no degree",
      education_level == 4 ~ "Associate degree in college - vocational",
      education_level == 5 ~ "Associate degree in college - academic",
      education_level == 6 ~ "Bachelor's degree",
      education_level == 7 ~ "Master's degree",
      education_level == 8 ~ "Professional school degree/doctoral degree"
    ),
    sexuality = case_when(
      sexuality == 1 ~ "Heterosexual or straight",
      sexuality == 2 ~ "Homosexual or gay (or lesbian)",
      sexuality == 3 ~ "Bisexual"
    )
  )
voting_trends
```

```{r}
voting_trends_dependent_abortion <- voting_trends |>
  ggplot(mapping = aes(x = abortion_views)) +
           geom_bar() +
  labs(
    x = "Views on Abortion on a Scale of 1-4",
    y = "Number of Respondents"
  )
voting_trends_dependent_abortion
```

```{r}
voting_trends_dependent_lgbtq <- voting_trends |>
  ggplot(mapping = aes(x = lgbtq_views)) +
           geom_bar() +
  labs(
    x = "Views on Gay Marriage on a Scale of 1-3",
    y = "Number of Respondents"
  )
voting_trends_dependent_lgbtq
```

```{r}
voting_trends_dependent_immigration <- voting_trends |>
  ggplot(mapping = aes(x = immigration_views)) +
           geom_bar() +
  labs(
    x = "Views on Immigration on a Scale of 1-4",
    y = "Number of Respondents"
  )
voting_trends_dependent_immigration
```

```{r}
voting_trends_dependent_environment <- voting_trends |>
  ggplot(mapping = aes(x = environment_views)) +
           geom_bar() +
  labs(
    x = "Views on the Environment on a Scale of 1-7",
    y = "Number of Respondents"
  ) 
voting_trends_dependent_environment
```

```{r}
voting_trends_dependent_economy <- voting_trends |>
  ggplot(mapping = aes(x = economy_views)) +
           geom_bar() +
  labs(
    x = "Views on the Economy on a Scale of 1-5",
    y = "Number of Respondents"
  )
voting_trends_dependent_economy
```

RESULTS: 

```{r}
voting_trends_dependent_tibble <- voting_trends |>
  summarize(
    avg_abortion = mean(abortion_views),
    avg_lgbtq = mean(lgbtq_views),
    avg_immigration = mean(immigration_views),
    avg_environment = mean(environment_views),
    avg_economy = mean(economy_views)
  )
knitr::kable(voting_trends_dependent_tibble,
             col.names = c("Average Views on Abortion", "Average Views on Gay Marriage", "Average Views on Immigration", "Average Views on the Environment", "Average Views on the Economy"))
```


```{r}
voting_tibble <- voting_trends |>
  group_by(party, race) |>
  summarize(
    avg_abortion = mean(abortion_views),
    avg_lgbtq = mean(lgbtq_views),
    avg_immigration = mean(immigration_views),
    avg_environment = mean(environment_views),
    avg_economy = mean(economy_views)
  )
knitr::kable(voting_tibble,
             col.names = c("Party Affiliation", "Race", "Views on Abortion", "Views on Gay Marriage", "Views on Immigration", "Views on the Environment", "Views on the Economy"))
```


```{r}
abortion_plot <- voting_tibble |>
  ggplot(mapping = aes(x = party, y = avg_abortion, fill = race)) +
  geom_col(position = "dodge") +
  labs(x = "Party Affiliation",
       y = "Average Views on Abortion")
abortion_plot
```

```{r}
lgbtq_plot <- voting_tibble |>
  ggplot(mapping = aes(x = party, y = avg_lgbtq, fill = race)) +
  geom_col(position = "dodge") +
  labs(x = "Party Affiliation",
       y = "Average Views on Gay Marriage")
lgbtq_plot
```

```{r}
immigration_plot <- voting_tibble |>
  ggplot(mapping = aes(x = party, y = avg_immigration, fill = race)) +
  geom_col(position = "dodge") +
  labs(x = "Party Affiliation",
       y = "Average Views on Immigration")
immigration_plot
```

```{r}
environment_plot <- voting_tibble |>
  ggplot(mapping = aes(x = party, y = avg_environment, fill = race)) +
  geom_col(position = "dodge") +
  labs(x = "Party Affiliation",
       y = "Average Views on the Environment")
environment_plot
```

```{r}
economy_plot <- voting_tibble |>
  ggplot(mapping = aes(x = party, y = avg_economy, fill = race)) +
  geom_col(position = "dodge") +
  labs(x = "Party Affiliation",
       y = "Average Views on the Economy")
economy_plot
```

```{r}
abortion_regression <- lm(abortion_views ~ race + party + education_level + gender + sexuality, data = voting_trends)
summary(abortion_regression)
```
**intercept represents avg lvl asian american  democrats
it's showing racial categories among democrats
```{r}
lgbtq_regression <- lm(lgbtq_views ~ race + party + education_level + gender + sexuality, data = voting_trends)
summary(lgbtq_regression)
```
```{r}
unique(voting_tibble$race)
```



```{r}
immigration_regression <- lm(immigration_views ~ race + party + education_level + gender + sexuality, data = voting_trends)
summary(immigration_regression)
```

```{r}
environment_regression <- lm(environment_views ~ race + party + education_level + gender + sexuality, data = voting_trends)
summary(environment_regression)
```

```{r}
economy_regression <- lm(economy_views ~ race + party + education_level + gender + sexuality, data = voting_trends)
summary(economy_regression)
```

CONCLUSION: 

***MAKE SURE TO CITE SOURCES

