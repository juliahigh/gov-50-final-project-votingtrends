---
title: "Gov 50 Final Project"
author: "Julia High"
description: "My final project"
output:
  distill::distill_article:
    self_contained: false
---

INTRODUCTION: 
- Introduce research question
- Introduce hypothesis
- Describe why it is interesting

DATA: 
- Describe the data source
- Describe how the key dependent and independent variables are measured
- Produces a plot that summarizes the dependent variable
- note if research design is cross-sectional or another type

RESULTS: 
- Scatterplot, barplot, or boxplot of the main relationship of interest
- output for the main regression of interest
- interpret the main coefficient of interest in regression
- comment on the statistical significance of the estimated coefficient and whether or not the coefficient represents a causal effect

CONCLUSION: 
- One paragraph that summarizes results
- assesses the extent to which you find support for your hypothesis
- describes limitations of your analysis 
- describes threats to inference
- states how your analysis could be improved


Research question: Do Democrat and Republican views on 5 major social issues differ by racial group?
Hypothesis: Democrat and Republican views on 5 major social issues will differ by racial group.


```{r}
library(tidyverse)
library(dplyr)
```

```{r}
voting_trends_2020 <- read_csv("anes_timeseries_2020_csv_20220210.csv")
voting_trends_2020
```

Race: V201549x
Abortion: V201336
LGBTQ+ Rights: V201416
Immigration: V201417
Environment: V201321
Economy: V201324
Party: V201018 (filter to include democrat and republican)
**maybe I could just do narm = true instead of filtering for the issues. so just filter for race and party!

```{r}
voting_trends_2020 <- voting_trends_2020 |>
  select(V201549x, V201336, V201416, V201417, V201321, V201324, V201018) |>
  filter(
    V201549x >= 1,
    V201018 == 1 | V201018 == 2,
    V201336 >= 1 | V201336 < 5
  )
voting_trends_2020
```
```{r}
voting_trends <- voting_trends_2020 |>
  rename(
    race_num = V201549x,
    abortion_views = V201336,
    lgbtq_views = V201416,
    immigration_views = V201417,
    environment_views = V201321,
    economy_views = V201324,
    party = V201018
  ) |>
  mutate(
    race = case_when(
      race_num == 1 ~ "White, non-Hispanic",
      race_num == 2 ~ "Black, non-Hispanic",
      race_num == 3 ~ "Hispanic",
      race_num == 4 ~ "Asian or Native Hawaiian/other Pacific Islander, non-Hispanic",
      race_num == 5 ~ "Native American/Alaska Native or other race, non-Hispanic",
      race_num == 6 ~ "Multiple races, non-Hispanic"
    ),
    party = if_else(party == 1, "Democrat", "Republican")
  )
voting_trends
```

IF IT'S DEPENDENT ALONE: 
```{r}
voting_trends_dependent <- voting_trends |>
  summarize(
    avg_abortion = mean(abortion_views),
    avg_lgbtq = mean(lgbtq_views),
    avg_immigration = mean(immigration_views),
    avg_environment = mean(environment_views),
    avg_economy = mean(economy_views)
  )
knitr::kable(voting_trends_dependent,
             col.names = c("Average Views on Abortion", "Average Views on Gay Marriage", "Average Views on Immigration", "Average Views on the Environment", "Average Views on the Economy"))
```

**To do this, I would have to make a different plot for each issue since 1-5 means different things
```{r}
voting_trends_dependent_plot <- voting_trends_dependent |>
  ggplot(mapping = aes(x = ))
  
```


IF IT'S DEPENDENT AND PARTY: 
```{r}
voting_trends_dependent_party <- voting_trends |>
  group_by(party) |>
  summarize(
    avg_abortion = mean(abortion_views),
    avg_lgbtq = mean(lgbtq_views),
    avg_immigration = mean(immigration_views),
    avg_environment = mean(environment_views),
    avg_economy = mean(economy_views)
  )
knitr::kable(voting_trends_dependent_party,
             col.names = c("Party", "Average Views on Abortion", "Average Views on Gay Marriage", "Average Views on Immigration", "Average Views on the Environment", "Average Views on the Economy"))
```


```{r}
voting_tibble <- voting_trends |>
  group_by(party, race) |>
  summarize(
    avg_abortion = mean(abortion_views),
    avg_lgbtq = mean(lgbtq_views),
    avg_immigration = mean(immigration_views),
    avg_environment = mean(environment_views),
    avg_economy = mean(economy_views)
  )
knitr::kable(voting_tibble,
             col.names = c("Party Affiliation", "Race", "Views on Abortion", "Views on Gay Marriage", "Views on Immigration", "Views on the Environment", "Views on the Economy"))
```


```{r}
abortion_plot <- voting_tibble |>
  ggplot(mapping = aes(x = party, y = avg_abortion, fill = race)) +
  geom_col(position = "dodge") +
  labs(x = "Party Affiliation",
       y = "Average Views on Abortion")
abortion_plot
```

```{r}
lgbtq_plot <- voting_tibble |>
  ggplot(mapping = aes(x = party, y = avg_lgbtq, fill = race)) +
  geom_col(position = "dodge") +
  labs(x = "Party Affiliation",
       y = "Average Views on Gay Marriage")
lgbtq_plot
```

```{r}
immigration_plot <- voting_tibble |>
  ggplot(mapping = aes(x = party, y = avg_immigration, fill = race)) +
  geom_col(position = "dodge") +
  labs(x = "Party Affiliation",
       y = "Average Views on Immigration")
immigration_plot
```

```{r}
environment_plot <- voting_tibble |>
  ggplot(mapping = aes(x = party, y = avg_environment, fill = race)) +
  geom_col(position = "dodge") +
  labs(x = "Party Affiliation",
       y = "Average Views on the Environment")
environment_plot
```


```{r}
economy_plot <- voting_tibble |>
  ggplot(mapping = aes(x = party, y = avg_economy, fill = race)) +
  geom_col(position = "dodge") +
  labs(x = "Party Affiliation",
       y = "Average Views on the Economy")
economy_plot
```

```{r}
abortion_regression <- lm(avg_abortion ~ race + party, data = voting_tibble)
summary(abortion_regression)
```
```{r}
lgbtq_regression <- lm(avg_lgbtq ~ race + party, data = voting_tibble)
summary(lgbtq_regression)
```

modelsummary::modelsummary(immigration_regression,
statistic = c("s.e. = {std.error}",
"p = {p.value}"),
coef_map = var_labels,
gof_map = c("nobs", "r.squared", "adj.r.squared"))

```{r}
immigration_regression <- lm(avg_immigration ~ race + party, data = voting_tibble)
summary(immigration_regression)
```

```{r}
environment_regression <- lm(avg_environment ~ race + party, data = voting_tibble)
summary(environment_regression)
```

```{r}
economy_regression <- lm(avg_economy ~ race + party, data = voting_tibble)
summary(economy_regression)
```


















